<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Car Photo Picker — GitHub-ready</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7c3aed; --muted:#94a3b8; --glass: rgba(255,255,255,0.04);
      --radius:16px; --glass-2: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; background: linear-gradient(180deg,#071427 0%, #081026 45%, #021017 100%); color:#e6eef8; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:32px}

    .app{
      width:100%; max-width:1100px; border-radius:20px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); box-shadow: 0 10px 30px rgba(2,6,23,0.8); padding:22px; display:grid; grid-template-columns:360px 1fr; gap:20px; align-items:start;
    }

    /* Top time */
    .topbar{grid-column:1/-1; display:flex; justify-content:space-between; align-items:center; margin-bottom:6px}
    .clock{font-weight:600; font-size:18px; background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); padding:10px 14px; border-radius:12px; color:var(--accent); box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02)}
    .title{font-size:14px; color:var(--muted)}

    /* Controls */
    .controls{background:var(--card); border-radius:var(--radius); padding:18px; box-shadow: 0 6px 18px rgba(2,6,23,0.6);}
    .controls h2{margin:0 0 12px 0; font-size:18px}
    label{display:block; font-size:13px; color:var(--muted); margin-bottom:8px}
    select,input[type="text"], .fileinput{width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,0.03); background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02)); color:inherit; margin-bottom:12px}
    .small{font-size:12px; color:var(--muted)}
    .btn{display:inline-block; padding:10px 14px; border-radius:12px; background:linear-gradient(90deg,var(--accent), #5b21b6); color:white; font-weight:600; border:none; cursor:pointer}
    .ghost{background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted)}

    /* Preview */
    .preview{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:var(--radius); padding:18px; min-height:420px; display:flex; flex-direction:column; gap:12px}
    .stage{flex:1; border-radius:12px; background:var(--glass); display:flex; align-items:center; justify-content:center; overflow:hidden; position:relative;}
    .stage img{max-width:100%; max-height:100%; object-fit:contain; display:block}
    .caption{position:absolute; left:18px; right:18px; bottom:18px; padding:12px 16px; border-radius:12px; background: linear-gradient(180deg, rgba(2,6,23,0.6), rgba(2,6,23,0.45)); color:white; font-weight:600; backdrop-filter: blur(6px); text-align:center}
    .meta{display:flex; justify-content:space-between; align-items:center}

    /* Responsive */
    @media (max-width:880px){ .app{grid-template-columns:1fr; padding:16px} .controls{order:2} .preview{order:1} }
  </style>
</head>
<body>
  <div class="app">
    <div class="topbar">
      <div>
        <div class="title">Шаблон: выбор авто • фото • подпись</div>
        <div style="font-size:12px; color:var(--muted)">Готово для размещения в GitHub Pages</div>
      </div>
      <div class="clock" id="clock">--:--:--</div>
    </div>

    <aside class="controls">
      <h2>Настройки</h2>

      <label for="carSelect">Выберите авто</label>
      <select id="carSelect">
        <option value="">-- выбрать --</option>
        <option value="https://images.unsplash.com/photo-1542362567-b07e54358753?auto=format&fit=crop&w=1200&q=60">Tesla Model S</option>
        <option value="https://images.unsplash.com/photo-1511919884226-fd3cad34687c?auto=format&fit=crop&w=1200&q=60">BMW M3</option>
        <option value="https://images.unsplash.com/photo-1541447274410-1a9b2f0a8b1e?auto=format&fit=crop&w=1200&q=60">Porsche 911</option>
        <option value="https://images.unsplash.com/photo-1503376780353-7e6692767b70?auto=format&fit=crop&w=1200&q=60">Mercedes-Benz</option>
      </select>

      <label for="fileInput">Или загрузите своё фото</label>
      <input id="fileInput" class="fileinput" type="file" accept="image/*">
      <div class="small">Поддерживается drag & drop прямо на область предпросмотра.</div>

      <label for="captionInput">Подпись (отображается на фото)</label>
      <input id="captionInput" type="text" placeholder="Введите текст подписи...">

      <div style="display:flex; gap:8px; margin-top:8px">
        <button class="btn" id="applyBtn">Применить</button>
        <button class="btn ghost" id="clearBtn">Сброс</button>
      </div>

      <hr style="border:none; height:1px; background:rgba(255,255,255,0.02); margin:14px 0">
      <div class="small">Инструкции для GitHub:</div>
      <ol style="font-size:13px; color:var(--muted); padding-left:18px">
        <li>Создайте новый репозиторий, загрузите этот файл как <code>index.html</code>.</li>
        <li>Включите GitHub Pages: Settings → Pages → main branch → / (root).</li>
        <li>Откройте страницу: <code>https://&lt;ваш-пользователь&gt;.github.io/&lt;репо&gt;/</code></li>
      </ol>
    </aside>

    <main class="preview">
      <div style="display:flex; justify-content:space-between; align-items:center">
        <div style="font-size:16px; font-weight:700">Предпросмотр</div>
        <div class="small">Автоматическое масштабирование и overlay подписи</div>
      </div>

      <div class="stage" id="stage" ondragover="event.preventDefault(); this.classList.add('drag');" ondragleave="this.classList.remove('drag');" ondrop="handleDrop(event)">
        <img id="photo" src="https://images.unsplash.com/photo-1542362567-b07e54358753?auto=format&fit=crop&w=1200&q=60" alt="car">
        <div class="caption" id="caption">Tesla Model S</div>
      </div>

      <div class="meta">
        <div class="small">Готово для публикации в GitHub Pages</div>
        <div style="display:flex; gap:8px">
          <button class="btn ghost" id="downloadBtn">Скачать изображение</button>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Clock
    const clockEl = document.getElementById('clock');
    function updateClock(){
      const d = new Date();
      const h = String(d.getHours()).padStart(2,'0');
      const m = String(d.getMinutes()).padStart(2,'0');
      const s = String(d.getSeconds()).padStart(2,'0');
      clockEl.textContent = `${h}:${m}:${s}`;
    }
    updateClock(); setInterval(updateClock, 1000);

    // Elements
    const carSelect = document.getElementById('carSelect');
    const fileInput = document.getElementById('fileInput');
    const captionInput = document.getElementById('captionInput');
    const applyBtn = document.getElementById('applyBtn');
    const clearBtn = document.getElementById('clearBtn');
    const photo = document.getElementById('photo');
    const caption = document.getElementById('caption');
    const stage = document.getElementById('stage');
    const downloadBtn = document.getElementById('downloadBtn');

    // Apply from selection or file
    carSelect.addEventListener('change', ()=>{
      if(carSelect.value) photo.src = carSelect.value;
      caption.textContent = carSelect.options[carSelect.selectedIndex].text || '';
    });

    fileInput.addEventListener('change', (e)=>{
      const f = e.target.files[0];
      if(!f) return;
      const url = URL.createObjectURL(f);
      photo.src = url;
      caption.textContent = f.name;
    });

    applyBtn.addEventListener('click', ()=>{
      caption.textContent = captionInput.value || (carSelect.options[carSelect.selectedIndex]?.text || '');
    });

    clearBtn.addEventListener('click', ()=>{
      captionInput.value = '';
      carSelect.selectedIndex = 0;
      photo.src = carSelect.options[1].value; // вернуть первый пример
      caption.textContent = '';
    });

    // Drag & drop
    function handleDrop(e){
      e.preventDefault();
      stage.classList.remove('drag');
      const file = e.dataTransfer.files && e.dataTransfer.files[0];
      if(file && file.type.startsWith('image/')){
        const url = URL.createObjectURL(file);
        photo.src = url;
        caption.textContent = file.name;
      }
    }

    // Simple download (renders canvas)
    downloadBtn.addEventListener('click', ()=>{
      // create canvas of the displayed image + caption
      const img = new Image();
      img.crossOrigin = 'anonymous';
      img.onload = ()=>{
        const w = img.naturalWidth;
        const h = img.naturalHeight;
        const canvas = document.createElement('canvas');
        canvas.width = w; canvas.height = h + Math.round(h*0.12);
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = '#081026'; ctx.fillRect(0,0,canvas.width,canvas.height);
        // draw image centered
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height - Math.round(h*0.12));
        // caption background
        ctx.fillStyle = 'rgba(2,6,23,0.6)';
        const captionHeight = Math.round(canvas.height*0.12);
        ctx.fillRect(0, canvas.height - captionHeight, canvas.width, captionHeight);
        // caption text
        ctx.fillStyle = '#fff'; ctx.font = `${Math.round(captionHeight*0.45)}px sans-serif`;
        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        const text = caption.textContent || '';
        ctx.fillText(text, canvas.width/2, canvas.height - captionHeight/2);

        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = 'car-preview.png';
        link.click();
      };
      img.onerror = ()=> alert('Не удалось подготовить изображение для скачивания (кросс-домен). Попробуйте загрузить фото локально или выбрать другое.');
      img.src = photo.src;
    });

  </script>
</body>
</html>
